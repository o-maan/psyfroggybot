/**
 * Утилита для адаптации текста под пол пользователя
 *
 * ВАЖНО: Лягушка ВСЕГДА мужского рода ("я рад", "я готов")
 * Меняются только обращения к пользователю ("ты сделал" → "ты сделала")
 */

/**
 * Адаптирует текст для женского пола
 * Заменяет окончания глаголов и прилагательных в обращениях к пользователю
 *
 * @param text - Исходный текст (написан для мужского рода)
 * @param gender - Пол пользователя ('male' | 'female' | 'unknown')
 * @returns Адаптированный текст
 */
export function adaptTextForGender(text: string, gender: 'male' | 'female' | 'unknown' | null): string {
  // Для мужского пола и unknown оставляем текст как есть
  if (gender !== 'female') {
    return text;
  }

  // Список замен ТОЛЬКО для обращений к пользователю (с "ты")
  // НЕ трогаем фразы от лица лягушки ("я рад", "я готов")
  // ВАЖНО: \b не работает с кириллицей! Используем пробелы и конец строки
  const replacements: Array<[RegExp, string]> = [
    // Глаголы прошедшего времени
    [/ты (не )?сделал(?=\s|$|[,!?.;])/gi, 'ты $1сделала'],
    [/ты (не )?справился(?=\s|$|[,!?.;])/gi, 'ты $1справилась'],
    [/ты (не )?почувствовал(?=\s|$|[,!?.;])/gi, 'ты $1почувствовала'],
    [/ты (не )?испытал(?=\s|$|[,!?.;])/gi, 'ты $1испытала'],
    [/ты (не )?заметил(?=\s|$|[,!?.;])/gi, 'ты $1заметила'],
    [/ты (не )?написал(?=\s|$|[,!?.;])/gi, 'ты $1написала'],
    [/ты (не )?пришел(?=\s|$|[,!?.;])/gi, 'ты $1пришла'],
    [/ты (не )?ответил(?=\s|$|[,!?.;])/gi, 'ты $1ответила'],
    [/ты (не )?поделился(?=\s|$|[,!?.;])/gi, 'ты $1поделилась'],
    [/ты (не )?попробовал(?=\s|$|[,!?.;])/gi, 'ты $1попробовала'],
    [/ты (не )?начал(?=\s|$|[,!?.;])/gi, 'ты $1начала'],
    [/ты (не )?закончил(?=\s|$|[,!?.;])/gi, 'ты $1закончила'],
    [/ты (не )?понял(?=\s|$|[,!?.;])/gi, 'ты $1поняла'],
    [/ты (не )?узнал(?=\s|$|[,!?.;])/gi, 'ты $1узнала'],
    [/ты (не )?нашел(?=\s|$|[,!?.;])/gi, 'ты $1нашла'],
    [/ты (не )?увидел(?=\s|$|[,!?.;])/gi, 'ты $1увидела'],
    [/ты (не )?услышал(?=\s|$|[,!?.;])/gi, 'ты $1услышала'],
    [/ты (не )?подумал(?=\s|$|[,!?.;])/gi, 'ты $1подумала'],
    [/ты (не )?решил(?=\s|$|[,!?.;])/gi, 'ты $1решила'],
    [/ты (не )?выбрал(?=\s|$|[,!?.;])/gi, 'ты $1выбрала'],
    [/ты (не )?описал(?=\s|$|[,!?.;])/gi, 'ты $1описала'],
    [/ты (не )?назвал(?=\s|$|[,!?.;])/gi, 'ты $1назвала'],
    [/ты (не )?вспомнил(?=\s|$|[,!?.;])/gi, 'ты $1вспомнила'],
    [/ты (не )?забыл(?=\s|$|[,!?.;])/gi, 'ты $1забыла'],
    [/ты (не )?смог(?=\s|$|[,!?.;])/gi, 'ты $1смогла'],
    [/ты (не )?захотел(?=\s|$|[,!?.;])/gi, 'ты $1захотела'],
    [/ты (не )?знал(?=\s|$|[,!?.;])/gi, 'ты $1знала'],
    [/ты (не )?хотел(?=\s|$|[,!?.;])/gi, 'ты $1хотела'],
    [/ты (не )?мог(?=\s|$|[,!?.;])/gi, 'ты $1могла'],
    [/ты (не )?был(?=\s|$|[,!?.;])/gi, 'ты $1была'],
    [/ты (не )?стал(?=\s|$|[,!?.;])/gi, 'ты $1стала'],
    [/ты (не )?пропал(?=\s|$|[,!?.;])/gi, 'ты $1пропала'],
    [/ты (не )?вернул(?=\s|$|[,!?.;])/gi, 'ты $1вернула'],
    [/ты (не )?заглянул(?=\s|$|[,!?.;])/gi, 'ты $1заглянула'],
    [/дописал(?=\s|$|[,!?.;])/gi, 'дописала'],
    [/пропал(?=\s|$|[,!?.;])/gi, 'пропала'],

    // Краткие прилагательные и состояния
    [/ты (не )?готов(?=\s|$|[,!?.;])/gi, 'ты $1готова'],
    [/ты (не )?рад(?=\s|$|[,!?.;])/gi, 'ты $1рада'],
    [/ты (не )?должен(?=\s|$|[,!?.;])/gi, 'ты $1должна'],
    [/ты (не )?обязан(?=\s|$|[,!?.;])/gi, 'ты $1обязана'],
    [/ты (не )?уверен(?=\s|$|[,!?.;])/gi, 'ты $1уверена'],
    [/ты (не )?прав(?=\s|$|[,!?.;])/gi, 'ты $1права'],
    [/ты (не )?согласен(?=\s|$|[,!?.;])/gi, 'ты $1согласна'],
    [/ты (не )?доволен(?=\s|$|[,!?.;])/gi, 'ты $1довольна'],
    [/ты (не )?свободен(?=\s|$|[,!?.;])/gi, 'ты $1свободна'],
    [/ты (не )?занят(?=\s|$|[,!?.;])/gi, 'ты $1занята'],
    [/ты (не )?устал(?=\s|$|[,!?.;])/gi, 'ты $1устала'],
    [/ты (не )?спокоен(?=\s|$|[,!?.;])/gi, 'ты $1спокойна'],
    [/ты (не )?счастлив(?=\s|$|[,!?.;])/gi, 'ты $1счастлива'],
    [/ты (не )?здоров(?=\s|$|[,!?.;])/gi, 'ты $1здорова'],
    [/ты (не )?болен(?=\s|$|[,!?.;])/gi, 'ты $1больна'],
    [/ты (не )?виноват(?=\s|$|[,!?.;])/gi, 'ты $1виновата'],

    // Причастия
    [/ты уставший(?=\s|$|[,!?.;])/gi, 'ты уставшая'],
    [/ты занятый(?=\s|$|[,!?.;])/gi, 'ты занятая'],
    [/ты готовый(?=\s|$|[,!?.;])/gi, 'ты готовая'],
  ];

  let result = text;

  // Применяем все замены
  for (const [pattern, replacement] of replacements) {
    result = result.replace(pattern, replacement);
  }

  return result;
}
