#!/bin/bash

echo "üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞..."
echo "================================"

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–º–∞–Ω–¥—ã –≤ –ª–æ–≥–∞—Ö
check_command() {
    local cmd=$1
    echo -n "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–∞–Ω–¥—ã $cmd... "
    
    # –ò—â–µ–º –∫–æ–º–∞–Ω–¥—É –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 50 —Å—Ç—Ä–æ–∫–∞—Ö –ª–æ–≥–∞
    if tail -n 50 bot.log | grep -q "$cmd"; then
        echo "‚úÖ –†–ê–ë–û–¢–ê–ï–¢"
        return 0
    else
        echo "‚ùå –ù–ï –ù–ê–ô–î–ï–ù–ê"
        return 1
    fi
}

# –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞
sleep 2

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–º–∞–Ω–¥—ã
check_command "/ping"
check_command "/test_button"
check_command "/fro"

echo "================================"
echo "–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ —Å –∫–æ–º–∞–Ω–¥–∞–º–∏:"
tail -n 20 bot.log | grep -E "(–ü–æ–ª—É—á–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞|updateType.*message)" | tail -5